version: 2

models:
  - name: mart_sa__team_stats
    description: ""
    columns:
      - name: season_id
        description: "Unique ID of the season within the competition"
        tests:
          - not_null

      - name: team_id
        description: "Unique ID of the team"
        tests:
          - not_null

      - name: season_year
        description: "Year extracted from season_end_date"

      - name: match_id
        description: "ID of the match (each match appears once per team)"

      - name: match_date
        description: "Date when the match was played"

      - name: matchday
        description: "Number of the matchday within the stage of the competition when the match was played"

      - name: global_matchday
        description: "Global matchday index across the whole season, useful for comparing team performance over time. Only present for matches actually played by the team. Gaps may exist if a team did not play in a given stage."

      - name: team_name
        description: "Name of the team"
        tests:
          - not_null

      - name: matches_played
        description: "Total matches played"

      - name: wins
        description: "Total matches won"

      - name: losses
        description: "Total matches lost"

      - name: draws
        description: "Total matches drawn"

      - name: points
        description: "Points earned in the match: 3 for a win, 1 for a draw, 0 for a loss."

      - name: home_pts
        description: "Points earned when playing at home (null if the team was away)."

      - name: away_pts
        description: "Points earned when playing away (null if the team was at home)."

      - name: goals_scored_home
        description: "Goals scored at home"

      - name: goals_conceded_home
        description: "Goals conceded at home"

      - name: goals_scored_away
        description: "Goals scored away"

      - name: goals_conceded_away
        description: "Goals conceded away"

      - name: goal_difference
        description: "Goal difference in the match"

      - name: goals_scored
        description: "Total goals scored"

      - name: goals_conceded
        description: "Total goals  conceded"

      - name: home_match_played
        description: "Matches played at home"

      - name: away_match_played
        description: "Matches played at away"

      - name: home_wins
        description: "Matches won at home"

      - name: home_draws
        description: "Matches drawn at home"

      - name: home_losses
        description: "Matches lost at home"

      - name: away_wins
        description: "Matches won away"

      - name: away_draws
        description: "Matches drawn away"

      - name: away_losses
        description: "Matches lost away"

      - name: home_comebacks
        description: "Number of home comebacks"

      - name: away_comebacks
        description: "Number of away comebacks"

      - name: home_collapses
        description: "Number of home collapses"

      - name: away_collapses
        description: "Number of away collapses"
